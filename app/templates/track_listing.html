{% extends "base.html" %}
{% block page_css %}
    <link href="{{ url_for('static', path='/css/pages/tracks.css') }}"
          rel="stylesheet" />
{% endblock page_css %}
{% block content %}
    <h1>{{ page_title }}</h1>
    {% if page_subtitle %}<p>{{ page_subtitle }}</p>{% endif %}
    <div class="row flex-row overflow-auto">
        {% for track in tracks %}
            <div class="col-3">
                <div class="card mb-3 track-card">
                    <a href="{{ url_for('track_detail', track_id=track.track_id) }}"
                       class="text-decoration-none">
                        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='180' height='120'><rect width='100%' height='100%' fill='%23cccccc'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='%23666' font-size='16'>No Image</text></svg>"
                             class="card-img-top track-card-img"
                             alt="No image available for {{ track.title }} by {{ track.artist }}" />
                        </a>
                        <div class="card-body p-2">
                            <a href="{{ url_for('track_detail', track_id=track.track_id) }}"
                               class="text-decoration-none text-reset">
                                <h5 class="card-title track-card-title">{{ track.title }}</h5>
                                <h6 class="card-subtitle mb-1 text-body-secondary track-card-artist">{{ track.artist }}</h6>
                            </a>
                            <p class="card-text mb-1 track-card-info">{{ track.bpm }} BPM, {{ track.music_key }}</p>
                            <p class="card-text mb-2 track-card-price">
                                <strong>${{ track.price }}</strong>
                            </p>
                            {% set track_ids = cart.items | map(attribute='track_id') | list %} {% set is_in_cart = track.track_id in track_ids %}
                            {% include
                            "partials/add_to_cart_button.html" %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endblock content %}
